(function(l,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],o):(l=typeof globalThis<"u"?globalThis:l||self,o(l.highlightInput={},l.Vue))})(this,function(l,o){"use strict";const h=["innerHTML","onKeydown","onKeyup"],_={name:"HighlightInput"},y=o.defineComponent({..._,props:{modelValue:{type:String,default:""},keywords:{type:Array,default:[]},color:{type:String,default:"#F56C6C"}},emits:["update:modelValue"],setup(r,{emit:a}){const p=r,d=o.ref(""),i=o.ref();let u=!1;o.watch(()=>p.modelValue,t=>{k(t)});const T=t=>t.replace(/[\-\/\\\^\$\*\+\?\.\(\)\|\[\]\{\}]/g,"\\$&"),v=t=>{var e="";return t.length==0?"":(e=t.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/ /g,"&nbsp;"),e=e.replace(/\'/g,"&#39;"),e=e.replace(/\"/g,"&quot;"),e=e.replace(/\n/g,"<br/>"),e)},w=t=>{var e="";return t.length==0?"":(e=t.replace(/&amp;/g,"&"),e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=e.replace(/&nbsp;/g," "),e=e.replace(/&#39;/g,"'"),e=e.replace(/&quot;/g,'"'),e=e.replace(/<br\/>/g,`
`),e)},S=(t,e)=>{if(!t)return"";const n=new RegExp(e.map(c=>T(String(c).trim())).join("|"),"gi");return t.replace(/\t/g,"").replace(n,"	$&	").split(/\t/).map((c,A)=>A%2===0?c:`<span style="color: ${p.color}">${c}</span>`).join("")},k=async t=>{let e=C(i.value),n=v(t);d.value=S(n,p.keywords),await o.nextTick(),R(i.value,e)},C=t=>{var s;t.focus();let e=(s=document.getSelection())==null?void 0:s.getRangeAt(0),n=e==null?void 0:e.cloneRange();return n==null||n.selectNodeContents(t),n==null||n.setEnd(e==null?void 0:e.endContainer,e==null?void 0:e.endOffset),n==null?void 0:n.toString().length},R=(t,e)=>{let n=getSelection(),s=g(i.value,{pos:e});s&&(s.collapse(!1),n==null||n.removeAllRanges(),n==null||n.addRange(s))},g=(t,e,n)=>{if(n||(n=document.createRange(),n.selectNode(t),n.setStart(t,0)),e.pos===0)n.setEnd(t,e.pos);else if(t&&e.pos>0)if(t.nodeType===Node.TEXT_NODE){let c=t.textContent||"";c.length<e.pos?e.pos-=c.length:(n.setEnd(t,e.pos),e.pos=0)}else for(var s=0;s<t.childNodes.length&&(n=g(t.childNodes[s],e,n),e.pos!==0);s++);return n},H=()=>{u=!0},I=t=>{u=!1,m(t)},m=t=>{if(!u){let e=t.target.innerText;a("update:modelValue",w(e||""))}},K=t=>{u=!0},N=t=>{u=!1};return(t,e)=>(o.openBlock(),o.createElementBlock("div",{ref_key:"inputDom",ref:i,innerHTML:d.value,class:"highlight-input",onInput:m,onCompositionstart:H,onCompositionend:I,contenteditable:"true",onKeydown:o.withKeys(K,["enter"]),onKeyup:o.withKeys(N,["enter"])},null,40,h))}}),D="",f=((r,a)=>{const p=r.__vccOpts||r;for(const[d,i]of a)p[d]=i;return p})(y,[["__scopeId","data-v-cbea2676"]]),x=[f],E={install(r){x.forEach(a=>{r.component(a.name,f)})}};l.HighlightInput=f,l.default=E,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});

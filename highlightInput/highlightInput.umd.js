(function(s,l){typeof exports=="object"&&typeof module<"u"?l(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],l):(s=typeof globalThis<"u"?globalThis:s||self,l(s.highlightInput={},s.Vue))})(this,function(s,l){"use strict";const _=["innerHTML"],x={name:"HighlightInput"},y=l.defineComponent({...x,props:{modelValue:{type:String,default:""},keywords:{type:Array,default:[]},color:{type:String,default:"#F56C6C"}},emits:["update:modelValue"],setup(r,{emit:a}){const p=r,u=l.ref(""),i=l.ref();let f=!1;l.watch(()=>p.modelValue,t=>{g(t)});const E=t=>t.replace(/[\-\/\\\^\$\*\+\?\.\(\)\|\[\]\{\}]/g,"\\$&"),S=t=>{var e="";return t.length==0?"":(e=t.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/ /g,"&nbsp;"),e=e.replace(/\'/g,"&#39;"),e=e.replace(/\"/g,"&quot;"),e=e.replace(/\n/g,"<br/>"),e)},k=t=>{var e="";return t.length==0?"":(e=t.replace(/&amp;/g,"&"),e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=e.replace(/&nbsp;/g," "),e=e.replace(/&#39;/g,"'"),e=e.replace(/&quot;/g,'"'),e=e.replace(/<br\/>/g,`
`),e)},C=(t,e)=>{if(!t)return"";const n=new RegExp(e.map(c=>E(String(c).trim())).join("|"),"gi");return t.replace(/\t/g,"").replace(n,"	$&	").split(/\t/).map((c,V)=>V%2===0?c:`<span style="color: ${p.color}">${c}</span>`).join("")},R=(t,e)=>{let n=null;return(...o)=>{n&&(clearTimeout(n),n=null),n=setTimeout(()=>{t.apply(this,o)},e)}},g=async t=>{let e=H(i.value),n=S(t);u.value=C(n,p.keywords),await l.nextTick(),I(i.value,e)},H=t=>{var o;t.focus();let e=(o=document.getSelection())==null?void 0:o.getRangeAt(0),n=e==null?void 0:e.cloneRange();return n==null||n.selectNodeContents(t),n==null||n.setEnd(e==null?void 0:e.endContainer,e==null?void 0:e.endOffset),n==null?void 0:n.toString().length},I=(t,e)=>{let n=getSelection(),o=m(i.value,{pos:e});o&&(o.collapse(!1),n==null||n.removeAllRanges(),n==null||n.addRange(o))},m=(t,e,n)=>{if(n||(n=document.createRange(),n.selectNode(t),n.setStart(t,0)),e.pos===0)n.setEnd(t,e.pos);else if(t&&e.pos>0)if(t.nodeType===Node.TEXT_NODE){let c=t.textContent||"";c.length<e.pos?e.pos-=c.length:(n.setEnd(t,e.pos),e.pos=0)}else for(var o=0;o<t.childNodes.length&&(n=m(t.childNodes[o],e,n),e.pos!==0);o++);return n},N=R(g,300),w=()=>{f=!0},A=t=>{f=!1,h(t)},h=t=>{if(!f){let e=t.target.textContent;a("update:modelValue",k(e||"")),N(e)}};return(t,e)=>(l.openBlock(),l.createElementBlock("div",{ref_key:"inputDom",ref:i,innerHTML:u.value,class:"highlight-input",onInput:h,onCompositionstart:w,onCompositionend:A,contenteditable:"true"},null,40,_))}}),$="",d=((r,a)=>{const p=r.__vccOpts||r;for(const[u,i]of a)p[u]=i;return p})(y,[["__scopeId","data-v-bc8dd032"]]),T=[d],v={install(r){T.forEach(a=>{r.component(a.name,d)})}};s.HighlightInput=d,s.default=v,Object.defineProperties(s,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
